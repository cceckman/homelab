---
# name: "Install Prometheus node_exporter"
# # Requires host facts
# hosts:
#   - storage
#   - rack18
#   - rack19
# roles:
#   - prometheus.prometheus.node_exporter
- name: "Configure prometheus servers"
  hosts: storage
  vars:
    prometheus_agent_mode: true
    prometheus_static_targets_files:
      - "prometheus/{{ ansible_facts.hostname }}/*.yml"
      - "prometheus/{{ ansible_facts.hostname }}/*.yaml"
    prometheus_remote_write:
      - url: https://prometheus-us-central1.grafana.net/api/prom/push
#       basic_auth:
#         username: !vault |
#           $ANSIBLE_VAULT;1.1;AES256
#           66393937363061653461383031633436363565643236626365316233626537333833626534613065
#           3966643565373536626664353035316639336330636635390a353631343930363339353038643137
#           31363336653338383266616639636565303339646235363639366665303933323237613432343038
#           6662613939613064350a613661643036396336656334376630393261316335653230633137636163
#           3238
#         password: !vault |
#           $ANSIBLE_VAULT;1.1;AES256
#           39626362633765313964356632346534633465623261653334323230386631626263353533363464
#           3131333038353830666133666630656433626665616638660a646662666139343931613932353733
#           62363966343137373962636464346464633239616337313334313434613761356433626135366433
#           3332653937663363320a353862643662626132313466626463653361303439383537653234363536
#           64616435306636396565356132626531393132326630633666313339336365323831306335316266
#           62613365346335653463396239616664386339396561356133613930663866393730623665636335
#           34383333383834376263616437653431346261666464396236646532373563353462353536643434
#           62313136653838643035633634323239313066373033643263646561363930633765393265383930
#           39356162323830313539653961386564336334373438333036666131306339303432
  roles:
    - prometheus.prometheus.prometheus

